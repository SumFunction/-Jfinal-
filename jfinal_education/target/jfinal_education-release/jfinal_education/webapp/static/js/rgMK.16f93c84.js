(window.webpackJsonp=window.webpackJsonp||[]).push([["rgMK"],{rgMK:function(e,t,i){"use strict";i.r(t);var o=i("t3Un"),a=function(e){return Object(o.a)({url:"/eduservice/after/eduChapter/findAllChapterAndVideoById?id="+e,method:"get"})},n=function(e){return Object(o.a)({url:"/eduservice/after/eduChapter/getChapterInfoById?id="+e,method:"get"})},s=function(e){return Object(o.a)({url:"/eduservice/after/eduChapter/addChapter",method:"post",data:e})},r=function(e){return Object(o.a)({url:"/eduservice/after/eduChapter/deleteChapterById?id="+e,method:"get"})},d=function(e){return Object(o.a)({url:"/eduservice/after/eduChapter/updateChapter",method:"post",data:e})},l=function(e){return Object(o.a)({url:"/eduservice/eduVideo/addVideo",method:"post",data:e})},c=function(e){return Object(o.a)({url:"/eduservice/eduVideo/deleleVideoById?id="+e,method:"get"})},u=function(e){return Object(o.a)({url:"/eduvod/deleteVodById?id="+e,method:"get"})},h=function(e){return Object(o.a)({url:"/eduservice/eduVideo/updateVideoById",method:"post",data:e})},p=function(e){return Object(o.a)({url:"/eduservice/eduVideo/findVideoById?id="+e,method:"get"})},v={data:function(){return{saveBtnDisabled:!1,data:[],defaultProps:{children:"children",label:"title"},chapter:{},video:{},fileList:[],dialogChapterFormVisible:!1,dialogVideoFormVisible:!1,BASE_API:"http://101.43.205.252:80"}},created:function(){this.init()},methods:{init:function(){var e=this;a(this.$route.params.id).then(function(t){e.data=t.data.items})},next:function(){this.$router.push({path:"/course/publish/"+this.$route.params.id})},filterNode:function(e,t){return!e||-1!==t.title.indexOf(e)},previous:function(){this.$router.push({path:"/course/editInformation/"+this.$route.params.id})},saveOrUpdateChapter:function(){null!=this.chapter.id?this.updateChapter():this.addChapter()},addChapter:function(){var e=this;this.chapter.courseId=this.$route.params.id,s(this.chapter).then(function(t){e.$message({type:"success",message:"添加成功！"}),e.dialogChapterFormVisible=!1,e.init()})},updateChapter:function(){var e=this;d(this.chapter).then(function(t){e.$message({type:"success",message:"修改成功！"}),e.dialogChapterFormVisible=!1,e.init()})},showChapter:function(e){var t=this;this.dialogChapterFormVisible=!0,n(e.id).then(function(e){t.chapter=e.data.item})},deleteChapter:function(e){var t=this;this.$confirm("此操作将永久删除该章节,是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r(e.id).then(function(e){t.$message({type:"success",message:"删除成功！"}),t.init()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},saveOrUpdateVideo:function(){null!=this.video.id?this.updateVideo():this.addVideo()},addVideo:function(){var e=this;l(this.video).then(function(t){e.$message({type:"success",message:"添加成功！"}),e.init(),e.dialogVideoFormVisible=!1})},showDialogVideo:function(e){this.fileList=[],this.video={},this.video.courseId=this.$route.params.id,this.dialogVideoFormVisible=!0,this.video.chapterId=e.id},showVideo:function(e){var t=this;this.dialogVideoFormVisible=!0,p(e).then(function(e){t.video=e.data.item})},updateVideo:function(){var e=this;h(this.video).then(function(t){e.$message({type:"success",message:"修改成功"}),e.init(),e.dialogVideoFormVisible=!1})},deleteVideo:function(e){var t=this;this.$confirm("此操作将永久删除该小节,是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){c(e).then(function(e){t.$message({type:"success",message:"成功删除"}),t.init()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleVodUploadSuccess:function(e,t,i){this.video.videoOriginalName=t.name,this.video.videoSourceId=e.data.videoId},handleUploadExceed:function(e,t){this.$message.warning("想要重新上传视频，请先删除已上传的视频")},handleVodRemove:function(){var e=this;u(this.video.videoSourceId).then(function(t){e.$message({type:"success",message:"删除成功!"}),e.fileList=[],e.video.videoSourceId="",e.video.videoOriginalName=""})},beforeVodRemove:function(e){return this.$confirm("确定移除 "+e.name+"？")}}},f=i("KHd+"),m=Object(f.a)(v,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("h2",{staticStyle:{"text-align":"center"}},[e._v("发布新课程")]),e._v(" "),i("el-steps",{staticStyle:{"margin-bottom":"40px"},attrs:{active:2,"process-status":"wait","align-center":""}},[i("el-step",{attrs:{title:"填写课程基本信息"}}),e._v(" "),i("el-step",{attrs:{title:"创建课程大纲"}}),e._v(" "),i("el-step",{attrs:{title:"提交审核"}})],1),e._v(" "),i("div",{staticClass:"app-container"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogChapterFormVisible=!0}}},[e._v("\n      添加章节\n    ")]),e._v(" "),i("el-tree",{staticClass:"filter-tree",attrs:{data:e.data,props:e.defaultProps,"filter-node-method":e.filterNode,"expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node,a=t.data;return i("span",{staticClass:"custom-tree-node"},[i("span",[e._v(e._s(o.label))]),e._v(" "),a.children?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){e.showChapter(a)}}},[e._v("\n          修改章节\n        ")]):e._e(),e._v(" "),a.children?i("el-button",{attrs:{slot:"reference",type:"text",size:"mini"},on:{click:function(t){e.deleteChapter(a)}},slot:"reference"},[e._v("\n          删除章节\n        ")]):e._e(),e._v(" "),a.children?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){e.showDialogVideo(a)}}},[e._v("\n          添加小节\n        ")]):e._e(),e._v(" "),a.children?e._e():i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){e.showVideo(a.id)}}},[e._v("\n          编辑小节\n        ")]),e._v(" "),a.children?e._e():i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){e.deleteVideo(a.id)}}},[e._v("\n          删除小节\n        ")])],1)}}])})],1),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogChapterFormVisible,title:"添加章节"},on:{"update:visible":function(t){e.dialogChapterFormVisible=t}}},[i("el-form",{attrs:{model:e.chapter,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"章节标题"}},[i("el-input",{model:{value:e.chapter.title,callback:function(t){e.$set(e.chapter,"title",t)},expression:"chapter.title"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogChapterFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.saveOrUpdateChapter}},[e._v("确 定")])],1)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogVideoFormVisible,title:"添加课时"},on:{"update:visible":function(t){e.dialogVideoFormVisible=t}}},[i("el-form",{attrs:{model:e.video,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"课时标题"}},[i("el-input",{model:{value:e.video.title,callback:function(t){e.$set(e.video,"title",t)},expression:"video.title"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"是否免费"}},[i("el-radio-group",{model:{value:e.video.isFree,callback:function(t){e.$set(e.video,"isFree",t)},expression:"video.isFree"}},[i("el-radio",{attrs:{label:0}},[e._v("免费")]),e._v(" "),i("el-radio",{attrs:{label:1}},[e._v("默认")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"上传视频"}},[i("el-upload",{staticClass:"upload-demo",attrs:{"on-success":e.handleVodUploadSuccess,"on-remove":e.handleVodRemove,"before-remove":e.beforeVodRemove,"on-exceed":e.handleUploadExceed,"file-list":e.fileList,action:e.BASE_API+"/eduvod/uploadVideo",limit:1}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上传视频")]),e._v(" "),i("el-tooltip",{attrs:{placement:"right-end"}},[i("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n              最大支持1G，"),i("br"),e._v("\n              支持3GP、ASF、AVI、DAT、DV、FLV、F4V、"),i("br"),e._v("\n              GIF、M2T、M4V、MJ2、MJPEG、MKV、MOV、MP4、"),i("br"),e._v("\n              MPE、MPG、MPEG、MTS、OGG、QT、RM、RMVB、"),i("br"),e._v("\n              SWF、TS、VOB、WMV、WEBM 等视频格式上传\n            ")]),e._v(" "),i("i",{staticClass:"el-icon-question"})])],1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVideoFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.saveOrUpdateVideo}},[e._v("确 定")])],1)],1),e._v(" "),i("el-form",{attrs:{"label-width":"120px"}},[i("el-form-item",[i("el-button",{attrs:{disabled:e.saveBtnDisabled,type:"primary"},on:{click:e.previous}},[e._v("返回上一步")]),e._v(" "),i("el-button",{attrs:{disabled:e.saveBtnDisabled,type:"primary"},on:{click:e.next}},[e._v("保存并下一步")])],1)],1)],1)},[],!1,null,null,null);m.options.__file="Chapter.vue";t.default=m.exports}}]);